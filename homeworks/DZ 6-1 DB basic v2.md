# Домашнее задание к занятию 1. «Типы и структура СУБД»

***
## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определённых данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- электронные чеки в json-виде,
- склады и автомобильные дороги для логистической компании,
- генеалогические деревья,
- кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации,
- отношения клиент-покупка для интернет-магазина.

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

###

Решение:

**- электронные чеки в json-виде**  
Документо-ориентированный NoSQL, так как такие БД хранят данные как документы. (Например: MongoDB)

**- склады и автомобильные дороги для логистической компании**  
Графовые БД, так как в такой структуре можно задавать дополнительные атрибуты для выбора оптимального маршрута (Например: Neo4j)

**- генеалогические деревья**  
Иерархическая или Графовая БД. В БД данные должны быть представлены в виде древовидной структуры (родитель - потомок). 

**- кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации**  
Key-Value БД. Например, можно использовать Redis, так как у него есть поддержка TTL, или Memcached (Memcached - по ощющениям будет быстрее работать).

**- отношения клиент-покупка для интернет-магазина**  
Реляционные БД, т.к. они обеспечивают связанность данных между различными таблицами. (Например: MySQL, MSSQL)

***
## Задача 2

Вы создали распределённое высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт — это отдельная реализация вашей системы и для каждого пункта нужно привести классификацию):

- данные записываются на все узлы с задержкой до часа (асинхронная запись);
- при сетевых сбоях система может разделиться на 2 раздельных кластера;
- система может не прислать корректный ответ или сбросить соединение.

Согласно PACELC-теореме как бы вы классифицировали эти реализации?

###

Решение:

**CAP-теорема**
- данные записываются на все узлы с задержкой до часа (асинхронная запись)  
CA - данные доступны и согласованы

- при сетевых сбоях система может разделиться на 2 раздельных кластера  
AP - данные доступны и устойчивы к разделению, но не согласованы в каждый момент времени

- система может не прислать корректный ответ или сбросить соединение  
CP - система в которой в случае сбоя запросы могут теряться.

**PACELC-теорема**
- данные записываются на все узлы с задержкой до часа (асинхронная запись)  
PC/EL - Данная архитектура при разделении стремится оставаться консистентной, а в случае без сетевых разделений, фокусируется на скорости ответа, отводя консистентность на второй план.

- при сетевых сбоях система может разделиться на 2 раздельных кластера  
PA/EL - Данные доступны, но не согласованы для всех узлов если они есть / консистентность данных здесь играет менее важную роль.

- система может не прислать корректный ответ или сбросить соединение  
PA/EC - Ставка делается на доступность, а при отсутствии распределения – на консистентность

***
## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

###

Решение:

Не могут,(из презентации в лекции: BASE — принцип, противопоставляющий себя ACID.)   
В основе BASE - доступность данных даже в ущерб согласованности.  
ACID же основывается на согласованности данных и надежности в случае сбоев.

***
## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни,
- реакция на истечение таймаута.

Вы слышали о key-value-хранилище, которое имеет механизм Pub/Sub. 
Что это за система? Какие минусы выбора этой системы?

###

Решение:

Так как MemCacheD не поддерживает механизм pub/sub, в данном случае остается один вариант - это система Redis.

Какие недостатки использования данной системы можно отметить:

1. Как было сказано в лекции - система однопоточна. То есть за один момент времени она способна обработать только один запрос. При большом количестве запросов будет скапливаться очередь ожидания, и тут мы переходим ко второму минусу, который одновременно и плюс конечно.
2. Данные хранятся в оперативной памяти. Это значит, что если у вас есть какие-то неполадки с питанием - вы будете терять данные, если у вас нет механизма записи на диск или если вы не используете Redis в совокупности с брокерами подключений, если я правильно понимаю логику работы данного решения.
3. Еще одним недостатком является семантика доставки Redis. Как сказано в официальном мануале - каждое сообщение пользователю будет отправлено только один раз. То есть если в это время произошел сбой у клиента, или пользователь просто отошел от ПК - сообщение будет потеряно. Никакого напоминания или повторной отправки самим Redis'ом не предусмотрено.

***